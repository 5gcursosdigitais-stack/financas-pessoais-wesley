<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finan√ßas Pessoais - Wesley Lopes</title>
    <style>
        /* CSS Variables para Tema Dark/Light */
        :root {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --accent: #3b82f6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0,0, 0.1);
            --radius: 12px;
        }

        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .theme-toggle {
            background: var(--accent);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: scale(1.05);
        }

        /* Dashboard KPIs */
        .kpis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .kpi-card {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            text-align: center;
            border-left: 4px solid var(--accent);
        }

        .kpi-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent);
            margin-bottom: 0.25rem;
        }

        .kpi-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Tabs */
        .tabs {
            display: flex;
            background: var(--bg-secondary);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .tab-btn {
            flex: 1;
            padding: 1rem;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .tab-btn.active {
            background: var(--accent);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        input, select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--accent);
        }

        .input-warning {
            border-color: var(--warning) !important;
            background: #fef3c7;
        }

        .input-danger {
            border-color: var(--danger) !important;
            background: #fee2e2;
        }

        /* Table */
        .table-container {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--accent);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: var(--bg-primary);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .btn-primary { background: var(--accent); color: white; }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn:hover { transform: translateY(-2px); box-shadow: var(--shadow); }

        /* Charts */
        .chart-container {
            height: 300px;
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        /* Mobile */
        @media (max-width: 768px) {
            .container { padding: 0.5rem; }
            .header { flex-direction: column; gap: 1rem; }
            .kpis { grid-template-columns: 1fr; }
            .tabs { flex-direction: column; }
            th, td { padding: 0.75rem 0.5rem; font-size: 0.9rem; }
        }

        /* Utils */
        .text-center { text-align: center; }
        .mb-2 { margin-bottom: 1rem; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        @media (max-width: 768px) { .grid-2 { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üí∞ Finan√ßas Pessoais</h1>
            <button class="theme-toggle" onclick="toggleTheme()">üåô Dark Mode</button>
        </header>

        <!-- KPIs Dashboard -->
        <div class="kpis">
            <div class="kpi-card">
                <div class="kpi-value" id="saldoAtual">R$ 0,00</div>
                <div class="kpi-label">Saldo Atual</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value" id="taxaPoupanca">0%</div>
                <div class="kpi-label">Taxa de Poupan√ßa</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value" id="patrimonioTotal">R$ 0,00</div>
                <div class="kpi-label">Patrim√¥nio Total</div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('dashboard')">üìä Dashboard</button>
            <button class="tab-btn" onclick="showTab('receitas')">üíµ Receitas</button>
            <button class="tab-btn" onclick="showTab('despesas')">üí∏ Despesas</button>
            <button class="tab-btn" onclick="showTab('investimentos')">üìà Investimentos</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="grid-2">
                <div class="chart-container">
                    <canvas id="graficoDespesas"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="graficoPatrimonio"></canvas>
                </div>
            </div>
            <div style="text-align: center; padding: 2rem;">
                <button class="btn btn-primary" onclick="exportCSV()">üì• Exportar CSV</button>
                <button class="btn btn-success" onclick="exportPDF()">üìÑ Exportar PDF</button>
                <button class="btn btn-danger" onclick="resetData()">üóëÔ∏è Resetar Dados</button>
            </div>
        </div>

        <!-- Receitas Tab -->
        <div id="receitas" class="tab-content">
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Descri√ß√£o</th>
                            <th>Valor (R$)</th>
                            <th>Tipo</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaReceitas"></tbody>
                </table>
            </div>
            <div class="form-group">
                <input type="date" id="dataReceita" required>
                <input type="text" id="descReceita" placeholder="Descri√ß√£o" required>
                <input type="number" id="valorReceita" placeholder="0,00" step="0.01" required>
                <select id="tipoReceita">
                    <option value="salario">Sal√°rio Fixo</option>
                    <option value="extra">Renda Extra</option>
                </select>
                <button class="btn btn-success" onclick="addReceita()">‚ûï Adicionar</button>
            </div>
        </div>

        <!-- Despesas Tab -->
        <div id="despesas" class="tab-content">
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Categoria</th>
                            <th>Descri√ß√£o</th>
                            <th>Valor (R$)</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaDespesas"></tbody>
                </table>
            </div>
            <div class="form-group grid-2">
                <div>
                    <label>Data</label>
                    <input type="date" id="dataDespesa" required>
                </div>
                <div>
                    <label>Categoria</label>
                    <select id="categoriaDespesa" required>
                        <option value="moradia">üè† Moradia/Aluguel</option>
                        <option value="alimentacao">üçö Alimenta√ß√£o</option>
                        <option value="transporte">üöó Transporte</option>
                        <option value="lazer">üéâ Lazer</option>
                        <option value="saude">üè• Sa√∫de</option>
                        <option value="educacao">üìö Educa√ß√£o</option>
                        <option value="outras">üìã Outras</option>
                    </select>
                </div>
                <div>
                    <label>Descri√ß√£o</label>
                    <input type="text" id="descDespesa" placeholder="O que foi gasto?" required>
                </div>
                <div>
                    <label>Valor (R$)</label>
                    <input type="number" id="valorDespesa" placeholder="0,00" step="0.01" required>
                </div>
            </div>
            <button class="btn btn-success" onclick="addDespesa()">‚ûï Adicionar Despesa</button>
        </div>

        <!-- Investimentos Tab -->
        <div id="investimentos" class="tab-content">
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Ativo</th>
                            <th>Aporte (R$)</th>
                            <th>Rentabilidade %</th>
                            <th>Saldo Atual (R$)</th>
                            <th>Proje√ß√£o 1 ano (R$)</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaInvestimentos"></tbody>
                </table>
            </div>
            <div class="form-group grid-2">
                <div>
                    <label>Tipo de Ativo</label>
                    <select id="tipoInvestimento" required>
                        <option value="acoes">üìà A√ß√µes</option>
                        <option value="fundos">üí∞ Fundos</option>
                        <option value="renda-fixa">üîí Renda Fixa</option>
                        <option value="cripto">‚Çø Criptomoedas</option>
                    </select>
                </div>
                <div>
                    <label>Aporte Inicial (R$)</label>
                    <input type="number" id="aporteInvestimento" placeholder="0,00" step="0.01" required>
                </div>
                <div>
                    <label>Rentabilidade Anual %</label>
                    <input type="number" id="rentabilidade" placeholder="8.5" step="0.1" required>
                </div>
                <div>
                    <label>Saldo Atual (R$)</label>
                    <input type="number" id="saldoAtualInv" placeholder="0,00" step="0.01" required>
                </div>
            </div>
            <button class="btn btn-success" onclick="addInvestimento()">‚ûï Adicionar Investimento</button>
        </div>
    </div>
<script>
// =====================================================
// PLANILHA FINANCEIRA MENSAL - Wesley Lopes (Localiza SP)
// Controle m√™s a m√™s com filtros e resumos autom√°ticos
// =====================================================

const MES_ATUAL = new Date().getMonth() + 1; // Janeiro = 1
const ANO_ATUAL = 2026;

let receitasMensais = JSON.parse(localStorage.getItem('receitasMensais')) || {};
let despesasMensais = JSON.parse(localStorage.getItem('despesasMensais')) || {};
let investimentosMensais = JSON.parse(localStorage.getItem('investimentosMensais')) || {};

// Inicializar com dados de exemplo (Janeiro 2026)
if (Object.keys(receitasMensais).length === 0) {
    const chaveMes = `${ANO_ATUAL}-${String(MES_ATUAL).padStart(2, '0')}`;
    receitasMensais[chaveMes] = [
        { data: '2026-01-05', descricao: 'Sal√°rio Localiza', valor: 4500, tipo: 'salario' },
        { data: '2026-01-15', descricao: 'Freelance Excel', valor: 800, tipo: 'extra' }
    ];
    despesasMensais[chaveMes] = [
        { data: '2026-01-02', categoria: 'moradia', descricao: 'Aluguel Mooca', valor: 1800 },
        { data: '2026-01-10', categoria: 'alimentacao', descricao: 'Supermercado P√£o de A√ß√∫car', valor: 650 },
        { data: '2026-01-12', categoria: 'transporte', descricao: 'Gasolina Uber', valor: 320 }
    ];
    investimentosMensais[chaveMes] = [
        { tipo: 'renda-fixa', aporte: 2000, rentabilidade: 12.5, saldoAtual: 2125 }
    ];
    salvarDados();
}

// Nomes dos meses (portugu√™s)
const NOMES_MESES = {
    1: 'Janeiro', 2: 'Fevereiro', 3: 'Mar√ßo', 4: 'Abril', 5: 'Maio', 6: 'Junho',
    7: 'Julho', 8: 'Agosto', 9: 'Setembro', 10: 'Outubro', 11: 'Novembro', 12: 'Dezembro'
};

let mesSelecionado = `${ANO_ATUAL}-${String(MES_ATUAL).padStart(2, '0')}`;
let anoSelecionado = ANO_ATUAL;

// ========================================
// FUN√á√ïES AUXILIARES
// ========================================
function formatarReal(valor) {
    return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(valor);
}

function obterMesAtualFormatado() {
    return `${NOMES_MESES[MES_ATUAL]} ${ANO_ATUAL}`;
}

function chaveMesAno(mes, ano) {
    return `${ano}-${String(mes).padStart(2, '0')}`;
}

function calcularJurosCompostos(principal, taxa, periodos) {
    return principal * Math.pow(1 + (taxa / 100), periodos);
}

// ========================================
// SALVAR/CARREGAR DADOS
// ========================================
function salvarDados() {
    localStorage.setItem('receitasMensais', JSON.stringify(receitasMensais));
    localStorage.setItem('despesasMensais', JSON.stringify(despesasMensais));
    localStorage.setItem('investimentosMensais', JSON.stringify(investimentosMensais));
    localStorage.setItem('mesSelecionado', mesSelecionado);
}

// ========================================
// CALCULAR KPIs (M√äS SELECIONADO)
// ========================================
function calcularKPIs() {
    const receitasMes = receitasMensais[mesSelecionado] || [];
    const despesasMes = despesasMensais[mesSelecionado] || [];
    const investimentosMes = investimentosMensais[mesSelecionado] || [];

    const totalReceitas = receitasMes.reduce((sum, r) => sum + r.valor, 0);
    const totalDespesas = despesasMes.reduce((sum, d) => sum + d.valor, 0);
    const saldo = totalReceitas - totalDespesas;
    const taxaPoupanca = totalReceitas > 0 ? ((totalReceitas - totalDespesas) / totalReceitas * 100) : 0;
    const patrimonio = investimentosMes.reduce((sum, i) => sum + i.saldoAtual, 0) + saldo;

    // Atualizar KPIs
    document.getElementById('saldoAtual').textContent = formatarReal(saldo);
    document.getElementById('taxaPoupanca').textContent = taxaPoupanca.toFixed(1) + '%';
    document.getElementById('patrimonioTotal').textContent = formatarReal(patrimonio);
    document.querySelector('.header h1').textContent = `üí∞ Finan√ßas - ${obterMesAtualFormatado()}`;

    // Alerta visual (80% do sal√°rio m√©dio SP)
    const kpiSaldo = document.getElementById('saldoAtual').parentElement;
    const orcamentoMensal = 4500 * 0.8;
    if (totalDespesas > orcamentoMensal) {
        kpiSaldo.style.borderLeftColor = 'var(--danger)';
        kpiSaldo.style.background = '#fee2e2';
    } else {
        kpiSaldo.style.borderLeftColor = 'var(--accent)';
        kpiSaldo.style.background = 'var(--bg-secondary)';
    }
}

// ========================================
// RENDERIZAR TABELAS (M√äS ATUAL)
// ========================================
function renderizarTabelas() {
    const receitasMes = receitasMensais[mesSelecionado] || [];
    const despesasMes = despesasMensais[mesSelecionado] || [];
    const investimentosMes = investimentosMensais[mesSelecionado] || [];

    // Tabela Receitas
    document.getElementById('tabelaReceitas').innerHTML = receitasMes.map((r, i) => `
        <tr>
            <td>${r.data}</td>
            <td>${r.descricao}</td>
            <td>${formatarReal(r.valor)}</td>
            <td>${r.tipo === 'salario' ? 'üíº Sal√°rio' : '‚≠ê Extra'}</td>
            <td><button class="btn btn-danger" onclick="removerItem('receitas', ${i})">üóëÔ∏è</button></td>
        </tr>
    `).join('');

    // Tabela Despesas
    document.getElementById('tabelaDespesas').innerHTML = despesasMes.map((d, i) => `
        <tr>
            <td>${d.data}</td>
            <td>${d.categoria}</td>
            <td>${d.descricao}</td>
            <td>${formatarReal(d.valor)}</td>
            <td><button class="btn btn-danger" onclick="removerItem('despesas', ${i})">üóëÔ∏è</button></td>
        </tr>
    `).join('');

    // Tabela Investimentos
    document.getElementById('tabelaInvestimentos').innerHTML = investimentosMes.map((inv, i) => {
        const projetado1ano = calcularJurosCompostos(inv.saldoAtual, inv.rentabilidade, 1);
        return `
            <tr>
                <td>${inv.tipo}</td>
                <td>${formatarReal(inv.aporte)}</td>
                <td>${inv.rentabilidade}%</td>
                <td>${formatarReal(inv.saldoAtual)}</td>
                <td>${formatarReal(projetado1ano)}</td>
                <td><button class="btn btn-danger" onclick="removerItem('investimentos', ${i})">üóëÔ∏è</button></td>
            </tr>
        `;
    }).join('');

    // Criar m√™s se n√£o existir
    if (!receitasMensais[mesSelecionado]) receitasMensais[mesSelecionado] = [];
    if (!despesasMensais[mesSelecionado]) despesasMensais[mesSelecionado] = [];
    if (!investimentosMensais[mesSelecionado]) investimentosMensais[mesSelecionado] = [];
}

// ========================================
// NAVEGA√á√ÉO ENTRE MESES
// ========================================
function trocarMes(delta) {
    const [ano, mes] = mesSelecionado.split('-').map(Number);
    let novoMes = mes + delta;
    let novoAno = ano;

    if (novoMes > 12) {
        novoMes = 1;
        novoAno++;
    } else if (novoMes < 1) {
        novoMes = 12;
        novoAno--;
    }

    mesSelecionado = chaveMesAno(novoMes, novoAno);
    renderizarTabelas();
    calcularKPIs();
    desenharGraficos();
}

// ========================================
// ADICIONAR ITENS (M√™s atual)
// ========================================
function addReceita() {
    const data = document.getElementById('dataReceita').value;
    const desc = document.getElementById('descReceita').value;
    const valor = parseFloat(document.getElementById('valorReceita').value);
    const tipo = document.getElementById('tipoReceita').value;

    if (data && desc && !isNaN(valor) && data.startsWith(mesSelecionado)) {
        if (!receitasMensais[mesSelecionado]) receitasMensais[mesSelecionado] = [];
        receitasMensais[mesSelecionado].push({ data, descricao: desc, valor, tipo });
        salvarDados();
        renderizarTabelas();
        calcularKPIs();
        limparFormReceita();
    } else {
        alert('‚ùå Data deve ser do m√™s selecionado!');
    }
}

function addDespesa() {
    const data = document.getElementById('dataDespesa').value;
    const categoria = document.getElementById('categoriaDespesa').value;
    const desc = document.getElementById('descDespesa').value;
    const valor = parseFloat(document.getElementById('valorDespesa').value);

    if (data && categoria && desc && !isNaN(valor) && data.startsWith(mesSelecionado)) {
        if (!despesasMensais[mesSelecionado]) despesasMensais[mesSelecionado] = [];
        despesasMensais[mesSelecionado].push({ data, categoria, descricao: desc, valor });
        salvarDados();
        renderizarTabelas();
        calcularKPIs();
        limparFormDespesa();
    } else {
        alert('‚ùå Data deve ser do m√™s selecionado!');
    }
}

function addInvestimento() {
    const tipo = document.getElementById('tipoInvestimento').value;
    const aporte = parseFloat(document.getElementById('aporteInvestimento').value);
    const rentabilidade = parseFloat(document.getElementById('rentabilidade').value);
    const saldoAtual = parseFloat(document.getElementById('saldoAtualInv').value);

    if (tipo && !isNaN(aporte) && !isNaN(rentabilidade) && !isNaN(saldoAtual)) {
        if (!investimentosMensais[mesSelecionado]) investimentosMensais[mesSelecionado] = [];
        investimentosMensais[mesSelecionado].push({ tipo, aporte, rentabilidade, saldoAtual });
        salvarDados();
        renderizarTabelas();
        calcularKPIs();
        limparFormInvestimento();
    }
}

// Limpar formul√°rios (mant√©m fun√ß√µes originais)
function limparFormReceita() { document.getElementById('dataReceita').value = mesSelecionado + '-01'; document.getElementById('descReceita').value = ''; document.getElementById('valorReceita').value = ''; }
function limparFormDespesa() { document.getElementById('dataDespesa').value = mesSelecionado + '-01'; document.querySelectorAll('#despesas input, #despesas select').forEach(input => input.value = ''); }
function limparFormInvestimento() { document.querySelectorAll('#investimentos input, #investimentos select').forEach(input => input.value = ''); }

// ========================================
// REMOVER ITENS
// ========================================
function removerItem(tipo, index) {
    if (confirm('Remover este item?')) {
        const dados = tipo === 'receitas' ? receitasMensais[mesSelecionado] :
                     tipo === 'despesas' ? despesasMensais[mesSelecionado] :
                     investimentosMensais[mesSelecionado];
        
        dados.splice(index, 1);
        salvarDados();
        renderizarTabelas();
        calcularKPIs();
    }
}

// ========================================
// GRAFICOS (mant√©m originais mas com dados mensais)
// ========================================
function desenharGraficos() {
    const ctxPie = document.getElementById('graficoDespesas').getContext('2d');
    const despesasMes = despesasMensais[mesSelecionado] || [];
    
    const despesasPorCategoria = {};
    despesasMes.forEach(d => {
        despesasPorCategoria[d.categoria] = (despesasPorCategoria[d.categoria] || 0) + d.valor;
    });

    const totalDespesas = Object.values(despesasPorCategoria).reduce((a, b) => a + b, 0);
    if (totalDespesas === 0) return;

    let startAngle = 0;
    ctxPie.clearRect(0, 0, 300, 300);
    
    Object.entries(despesasPorCategoria).forEach(([cat, valor]) => {
        const sliceAngle = (2 * Math.PI * valor / totalDespesas);
        ctxPie.fillStyle = {
            'moradia': '#ef4444', 'alimentacao': '#10b981', 'transporte': '#3b82f6',
            'lazer': '#f59e0b', 'saude': '#8b5cf6', 'educacao': '#06b6d4', 'outras': '#6b7280'
        }[cat];
        ctxPie.beginPath();
        ctxPie.moveTo(150, 150);
        ctxPie.arc(150, 150, 120, startAngle, startAngle + sliceAngle);
        ctxPie.closePath();
        ctxPie.fill();
        startAngle += sliceAngle;
    });
}

// Export e outras fun√ß√µes mant√™m iguais (exportCSV, etc.)
function exportCSV() {
    const dadosMes = [
        ['TIPO', 'M√äS', 'DATA', 'DESCRI√á√ÉO', 'VALOR', 'CATEGORIA'],
        ...((receitasMensais[mesSelecionado] || []).map(r => ['RECEITA', mesSelecionado, r.data, r.descricao, r.valor, r.tipo])),
        ...((despesasMensais[mesSelecionado] || []).map(d => ['DESPESA', mesSelecionado, d.data, d.descricao, d.valor, d.categoria])),
        ...((investimentosMensais[mesSelecionado] || []).map(i => ['INVESTIMENTO', mesSelecionado, '', i.tipo, i.saldoAtual, i.rentabilidade + '%']))
    ].map(row => row.join(',')).join('\n');
    
    const blob = new Blob([dadosMes], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `financas_${mesSelecionado}.csv`;
    a.click();
}

// Manter outras fun√ß√µes (resetData, toggleTheme, etc.) iguais ao c√≥digo original

// ========================================
// INICIALIZA√á√ÉO
// ========================================
document.addEventListener('DOMContentLoaded', function() {
    // Adicionar controles de m√™s no Header
    document.querySelector('.header').innerHTML += `
        <div style="display: flex; gap: 0.5rem; font-size: 1.1rem;">
            <button class="btn btn-primary" onclick="trocarMes(-1)" title="M√™s anterior">‚óÄÔ∏è</button>
            <span id="mesAtual" style="padding: 0.5rem; font-weight: bold;">${obterMesAtualFormatado()}</span>
            <button class="btn btn-primary" onclick="trocarMes(1)" title="Pr√≥ximo m√™s">‚ñ∂Ô∏è</button>
        </div>
    `;
    
    renderizarTabelas();
    calcularKPIs();
    desenharGraficos();
    
    // Datas padr√£o do m√™s atual
    const primeiroDiaMes = mesSelecionado + '-01';
    document.getElementById('dataReceita').value = primeiroDiaMes;
    document.getElementById('dataDespesa').value = primeiroDiaMes;
});
</script>
</body>
</html>
